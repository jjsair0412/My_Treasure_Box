# Class Imbalance
## Class Imbalance 란 ?
기계 학습과 분류 문제에서 발생하는 현상중 하나.

하나의 클래스가 다른 클래스에 비해 데이터 포인트 수가 현저히 적을 때 발생함.
- ex) 희귀 질병을 감지하는 분류 모델에서 질병이 있는 경우(양성 클래스) 데이터가 드물게 발생하는 경우

현실 세계의 데이터는 애초에 불균형하기에 해당 문제가 발생함.
- 예를들어 카드거래에서 대부분의 거래는 정상거래고, 드물게 사기거래가 발생.
    또한 데이터 수집 과정에서 클래스 불균형이 발생할 수 도 있음.. 샘플링이 잘못되거나 라벨링이 잘못되거나, 데이터수집이 잘못된 경우

## Class Imbalance 의 중요성
실제 ML 응용분야에서 많이 사용되는데, 클래스 불균형을 무시하면 큰 문제가 발생할 위험이 있음.

예를들어 아래와 같은 문제가 발생할 확률이 있음.
### 1. **모델 편향**
    모델이 소수 클래스, 양이적은 데이터에 대해 올바르게 식별하지 못할 수 있음.

    예를들어 희귀 질병을 분류하지 못할 수 있음.

### 2. **비용 예측 실패**
    소수 클래스의 중요도가 높을 경우에 이를 반영하지 않는다면 비용이나 성능이 실제와 다를 수 있음.


### 3. **평가 지표의 왜곡**
    정확도와 같은 평가지표가 왜곡되어 실제 모델의 성능을 평가하기 어렵게 만듬

# Class Imbalance 조절방안
Class Imbalance를 조절하는것은 , 소수 모델에 대해 모델성능을 향상시키고 , 오분류 비용을 줄이며 모델 실용성을 향상시킨다는것에 의미가 있음.

Class Imbalance 조절 방법은 크게 두가지로 분류됨

- **1. 데이터 기반 접근법**
    Resampling 으로 데이터 수를 조절하여 클래스 간 균형을 맞춘다.

- **2. ML Algorithm 접근법**
    Model Parameter를 조절하여 class imbalance를 고려하도록 모델을 튜닝한다.

## 데이터 기반 접근법 - Resampling
### 개념
데이터의 수를 조절해서 Class Imbalancer를 맞추는 개념임. 

데이터 수를 늘리는것은 `OverSampling` 이라 하고, 데이터 수를 줄이는것은 `UnderSampling` 이라 함.

### Resampling 종류
세가지로 나뉨.

- **1. OverSampling**
    소수 클래스 데이터를 증가시키는것. 새로운 데이터 포인트를 합성해서 데이터 셋 균형을 맞춤

    데이터 수집 자체가 비용이기때문에 비용적 단점을 가지고 있음. 또한 소수의 클래스 데이터들에 대해 확대 해석을 해버려서 모델 정확도가 낮아질 수 있음.

- **2. UnderSampling**
    다수 클래스 데이터를 감소시키는것. 다수 클래스에서 일부 데이터를 제거하여 균형을 맞춘다.

    ML 분야에서는 데이터 자체가 굉장히 주요하게 작동하고 소중한 자산인데, 억지로 줄인다는것은 많은 문제를 일으킬 수 있음.

- **3. Combined Sampling**
    OverSampling과 UnderSampling 둘을 합친것



## ML Algorithm 접근법 - 모델 튜닝 및 파라미터 조정 접근법
### 개념
데이터보다는 모델 자체가 데이터를 학습할 때 클래스 불균형을 해소할 수 있도록 모델을 튜닝하는것.

모델은 소수 클래스를 더 잘 식별할 수 있게 해줌.

### 종류
- **1. Weight 조정**
    가중치 조절하여 소수 클래스에 대해 높은 중요도를 부여하여 더 잘 식별할 수 있게 하는것.

- **2. Threshold 조정**
    분류 모델에서 임계값을 조정하여 모델 평가 지표를 향상시킴. 예측의 확률값을 조절함. 

    ex) 빨간색일 확률 60% , 파란색일 확률 40%

