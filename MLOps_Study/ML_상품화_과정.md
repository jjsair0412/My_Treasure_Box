# ML 상품화 과정
Production용 ML 에서는 다양한 모델 개발 과정을 거치게 됨.

## 모델 개발을 위한 과정
### 1단계 : 학습 데이터 준비
머신러닝 모델의 목적에 맞춰서 학습데이터를 준비
- Data 수집, Data 유형에 따른 처리, Data Sampling, Labeling, Class Imbalance 고려
- 해당 과정이 가장중요한 과정. 좋은 데이터를 수집하는것이 정확도가 높은 모델을 만들 수 있음

### 2단계 : Feature Engineering
수집된 데이터를 모델이 학습할 수 있도록 변경시키는 Engineering 과정
- Data Cleansing, Feature Selection, Feature Reduction, Data Augmentation, Data Scaling & Encoding

### 3단계 : 모델 학습 및 최적화 평가
모델을 목적에 맞게 학습하고 평가하며 최적화 함.
- Model Training, Model Evaluation, Model Hyperparameter Tuning, Model Selection, Ensembles & Auto ML

## 단계별 상세 과정
***숙박 어플리케이션을 개발한다는 가정을 두고 , 모댈 개발 단계별로 발생되는 일들을 자세히 설명함***

**요구사항**
- 숙박 추천 시스템용 모델 개발

### 1단계 : 학습데이터 준비
#### 데이터 수집 방법 설계
외부 DB에서 호텔정보 및 리뷰 데이터를 수집하여 데이터셋을 구성하고 설계함.

이때 어떤 데이터를 수집하는지에 대한 프로토콜들을 설계함.

요구사항에 맞는 필요한 데이터를 수집해야 함.

#### 개인 정보 보호 검토
수집 대상 데이터를 계획에 따라 수집했을 때, 개인정보 보호법에 위반되는 사례가 없는지 확인하고 검토해야 함.

데이터 수집을 위한 문서를 확충해야 함. (개인정보 수집 동의 등)

#### 숙박 데이터 수집
크롤링, 오픈소스 등으로 데이터를 수집하고, 수집한 데이터를 저장할 스토리지를 요구사항에 맞게끔 선택함.
- NoSQL (ES), Data Leak (하둡), Object Storage, ....등

#### 레이블링 (정답셋)
데이터 레이블(정답셋) 이 없을 경우, 어떻게 이 문제를 해결할것인가에 대한 검토가 필요함.
- 인력을 활용하거나 외부 기업을 활용함

### 2단계 : Feature Engineering
#### 데이터 정제 및 결측치 처리
수집한 호텔 정보, 리뷰정보를 자연어처리 과정을 통해 전처리 해야됨. 

잘못된 데이터는 특정 방법을 통해 처리해야함.
- 리뷰가 없다면 어떻게 해라 등

#### 데이터 분석
수집된 데이터들이 불균형문제가 있는지, 데이터가 잘못되진 않았는지 파악해야 함.

사용할 데이터에 대해서 검토함.

데이터가 잘못되었다면 1단계로 돌아가서 수집방법을 고치거나 하는 방법을 통해 문제점을 해소해야 함.

#### 변환 및 스케일링
수집된 데이터의 여러 특성을 고려하여 수치화 하고 스케일링 진행.
- 예를들어 서울에 위치한 숙박시설이라면 0, 부산은 1, 대전은 2,,, 이런식으로 자연어를 컴퓨터가 이해할 수 있는 언어로 변환함.

범주형 특성이 있는 경우, One-hot 인코딩 등으로 수치화 진행

#### 데이터 분할 및 검증 세트 구성
전체 데이터 셋을 훈련, 검증 및 테스트로 나누어 모델 훈련에 활용할 수 있도록 저장함.

이때 다양한 팀에서 사용할 수 있도록 적절한 저장 형식과 스토리지를 선택해야 함.

### 3단계 - 1 : 모델 학습
#### 1. 여러가지 머신러닝 알고리즘 검토
선형 회귀, 의사결정 트리, 랜덤 포레스트, SVM, 신경망 등 다양한 모델 학습 알고리즘을 검토함.

각 알고리즘들의 특성을 파아하고 모델 선택에 반영하며 반복하여 테스트함.

#### 2. 모델 선택 프로세스
모델 요구사항에 맞는 평가 지표 설정(일부 숙박업소만 추천하진 않는지, 리뷰가 적은 숙박업소도 적절하게 추천하는지) 하고, 검증 세트를 사용하여 여러가지 알고리즘의 성능을 비교함.
- 이때 ***메트릭 (평가지표) 을 잘 선택하는것이 중요함.***

최종적으로 모델을 선택하고 훈련한다.

#### 3. 모델 훈련 및 성능 평가
모델을 훈련하며 하이퍼파라미터를 조정하며, 다양한 평가 지표를 활용하여 검증 세트에 대한 예측 성능을 평가한다.

### 3단계 - 2 : 모델 성능 향상
#### 하이퍼 파라미터 튜닝
최적의 하이퍼파라미터를 찾기 위하여 그리드 탐색, 랜덤 탐색, 베이지안 최적화 등의 방법을 사용

#### 앙상블 기법
다양한 알고리즘의 결과를 결합하여, 보다 정확한 예측이 가능한지 테스트

#### 오차 분석 및 해결
모델이 잘못예측한 샘플에 대한 오차를 분석하여, 모델 성능을 개선할 수 있는 방법을 모색해야 함.


### 3단계 - 3 : 모델 상품화 검토 (평가)
#### 성능 평가 결과
85% 이상의 정확도를 보이며 , 해석 가능성 등을 평가함.

#### 성능 개선의 가능성
성능을 개선하기 위해 데이터양을 증가시키거나, 특성을 추가하거나, 더 나은 성능을 보이는 알고리즘 도입등의 방법을 통해 모델 성능을 더욱 개선할 수 있을지 여부를 검토함.

#### 적용 가능한 지 검토
성능 외에 추론속도, 지연시간 등을 검토함.

A/B Test 검토